{"version":3,"file":"file-store.js","names":["_FileStore","data","_interopRequireDefault","require","obj","__esModule","default","_defineProperty","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","debug","ExpoMetroFileStore","constructor","options","fileStore","FileStore","get","result","set","_value$output","_value$output$","_value$output$$data","src","output","code","match","clear","exports"],"sources":["../src/file-store.ts"],"sourcesContent":["import FileStore from 'metro-cache/src/stores/FileStore';\n\nconst debug = require('debug')('expo:metro:cache') as typeof console.log;\n\nexport class ExpoMetroFileStore<T> {\n  private fileStore: FileStore<T>;\n\n  constructor(options: any) {\n    this.fileStore = new FileStore<T>(options);\n  }\n\n  async get(key: Buffer): Promise<T | null> {\n    const result = await this.fileStore.get(key);\n    return result;\n  }\n\n  async set(key: Buffer, value: any): Promise<void> {\n    const src = value?.output?.[0]?.data?.code;\n    if (src) {\n      if (src.match(/^(?:[\\s\\t]+)\\/\\/(?:\\s+)?@metro no-cache/m)) {\n        debug('Skipping caching');\n        return;\n      }\n    }\n    return await this.fileStore.set(key, value);\n  }\n\n  clear(): void {\n    this.fileStore.clear();\n  }\n}\n"],"mappings":";;;;;;AAAA,SAAAA,WAAA;EAAA,MAAAC,IAAA,GAAAC,sBAAA,CAAAC,OAAA;EAAAH,UAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAAyD,SAAAC,uBAAAE,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAAA,SAAAG,gBAAAH,GAAA,EAAAI,GAAA,EAAAC,KAAA,IAAAD,GAAA,GAAAE,cAAA,CAAAF,GAAA,OAAAA,GAAA,IAAAJ,GAAA,IAAAO,MAAA,CAAAC,cAAA,CAAAR,GAAA,EAAAI,GAAA,IAAAC,KAAA,EAAAA,KAAA,EAAAI,UAAA,QAAAC,YAAA,QAAAC,QAAA,oBAAAX,GAAA,CAAAI,GAAA,IAAAC,KAAA,WAAAL,GAAA;AAAA,SAAAM,eAAAM,GAAA,QAAAR,GAAA,GAAAS,YAAA,CAAAD,GAAA,2BAAAR,GAAA,gBAAAA,GAAA,GAAAU,MAAA,CAAAV,GAAA;AAAA,SAAAS,aAAAE,KAAA,EAAAC,IAAA,eAAAD,KAAA,iBAAAA,KAAA,kBAAAA,KAAA,MAAAE,IAAA,GAAAF,KAAA,CAAAG,MAAA,CAAAC,WAAA,OAAAF,IAAA,KAAAG,SAAA,QAAAC,GAAA,GAAAJ,IAAA,CAAAK,IAAA,CAAAP,KAAA,EAAAC,IAAA,2BAAAK,GAAA,sBAAAA,GAAA,YAAAE,SAAA,4DAAAP,IAAA,gBAAAF,MAAA,GAAAU,MAAA,EAAAT,KAAA;AAEzD,MAAMU,KAAK,GAAG1B,OAAO,CAAC,OAAO,CAAC,CAAC,kBAAkB,CAAuB;AAEjE,MAAM2B,kBAAkB,CAAI;EAGjCC,WAAWA,CAACC,OAAY,EAAE;IAAAzB,eAAA;IACxB,IAAI,CAAC0B,SAAS,GAAG,KAAIC,oBAAS,EAAIF,OAAO,CAAC;EAC5C;EAEA,MAAMG,GAAGA,CAAC3B,GAAW,EAAqB;IACxC,MAAM4B,MAAM,GAAG,MAAM,IAAI,CAACH,SAAS,CAACE,GAAG,CAAC3B,GAAG,CAAC;IAC5C,OAAO4B,MAAM;EACf;EAEA,MAAMC,GAAGA,CAAC7B,GAAW,EAAEC,KAAU,EAAiB;IAAA,IAAA6B,aAAA,EAAAC,cAAA,EAAAC,mBAAA;IAChD,MAAMC,GAAG,GAAGhC,KAAK,aAALA,KAAK,wBAAA6B,aAAA,GAAL7B,KAAK,CAAEiC,MAAM,cAAAJ,aAAA,wBAAAC,cAAA,GAAbD,aAAA,CAAgB,CAAC,CAAC,cAAAC,cAAA,wBAAAC,mBAAA,GAAlBD,cAAA,CAAoBtC,IAAI,cAAAuC,mBAAA,uBAAxBA,mBAAA,CAA0BG,IAAI;IAC1C,IAAIF,GAAG,EAAE;MACP,IAAIA,GAAG,CAACG,KAAK,CAAC,0CAA0C,CAAC,EAAE;QACzDf,KAAK,CAAC,kBAAkB,CAAC;QACzB;MACF;IACF;IACA,OAAO,MAAM,IAAI,CAACI,SAAS,CAACI,GAAG,CAAC7B,GAAG,EAAEC,KAAK,CAAC;EAC7C;EAEAoC,KAAKA,CAAA,EAAS;IACZ,IAAI,CAACZ,SAAS,CAACY,KAAK,EAAE;EACxB;AACF;AAACC,OAAA,CAAAhB,kBAAA,GAAAA,kBAAA"}