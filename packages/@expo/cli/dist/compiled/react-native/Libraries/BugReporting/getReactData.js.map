{"version":3,"names":["getData","element","children","props","state","context","updater","name","type","text","publicInstance","nodeType","_currentElement","_renderedComponent","_instance","Object","keys","length","_renderedChildren","childrenList","getName","_stringText","displayName","inst","setState","bind","forceUpdate","setInProps","setInState","setInContext","internalInst","path","value","assign","copyWithSet","setIn","obj","last","pop","parent","reduce","obj_","attr","res","push","copyWithSetImpl","idx","key","updated","Array","isArray","slice","module","exports"],"sources":["getReactData.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * @flow\n */\n\n'use strict';\n\n/**\n * Convert a react internal instance to a sanitized data object.\n *\n * This is shamelessly stolen from react-devtools:\n * https://github.com/facebook/react-devtools/blob/HEAD/backend/getData.js\n */\nfunction getData(element: Object): Object {\n  let children = null;\n  let props = null;\n  let state = null;\n  let context = null;\n  let updater = null;\n  let name = null;\n  let type = null;\n  let text = null;\n  let publicInstance = null;\n  let nodeType = 'Native';\n  // If the parent is a native node without rendered children, but with\n  // multiple string children, then the `element` that gets passed in here is\n  // a plain value -- a string or number.\n  if (typeof element !== 'object') {\n    nodeType = 'Text';\n    text = element + '';\n  } else if (\n    element._currentElement === null ||\n    element._currentElement === false\n  ) {\n    nodeType = 'Empty';\n  } else if (element._renderedComponent) {\n    nodeType = 'NativeWrapper';\n    children = [element._renderedComponent];\n    props = element._instance.props;\n    state = element._instance.state;\n    context = element._instance.context;\n    if (context && Object.keys(context).length === 0) {\n      context = null;\n    }\n  } else if (element._renderedChildren) {\n    children = childrenList(element._renderedChildren);\n  } else if (element._currentElement && element._currentElement.props) {\n    // This is a native node without rendered children -- meaning the children\n    // prop is just a string or (in the case of the <option>) a list of\n    // strings & numbers.\n    children = element._currentElement.props.children;\n  }\n\n  if (!props && element._currentElement && element._currentElement.props) {\n    props = element._currentElement.props;\n  }\n\n  // != used deliberately here to catch undefined and null\n  if (element._currentElement != null) {\n    type = element._currentElement.type;\n    if (typeof type === 'string') {\n      name = type;\n    } else if (element.getName) {\n      nodeType = 'Composite';\n      name = element.getName();\n      // 0.14 top-level wrapper\n      // TODO(jared): The backend should just act as if these don't exist.\n      if (\n        element._renderedComponent &&\n        element._currentElement.props ===\n          element._renderedComponent._currentElement\n      ) {\n        nodeType = 'Wrapper';\n      }\n      if (name === null) {\n        name = 'No display name';\n      }\n    } else if (element._stringText) {\n      nodeType = 'Text';\n      text = element._stringText;\n    } else {\n      name = type.displayName || type.name || 'Unknown';\n    }\n  }\n\n  if (element._instance) {\n    const inst = element._instance;\n    updater = {\n      setState: inst.setState && inst.setState.bind(inst),\n      forceUpdate: inst.forceUpdate && inst.forceUpdate.bind(inst),\n      setInProps: inst.forceUpdate && setInProps.bind(null, element),\n      setInState: inst.forceUpdate && setInState.bind(null, inst),\n      setInContext: inst.forceUpdate && setInContext.bind(null, inst),\n    };\n    publicInstance = inst;\n\n    // TODO: React ART currently falls in this bucket, but this doesn't\n    // actually make sense and we should clean this up after stabilizing our\n    // API for backends\n    if (inst._renderedChildren) {\n      children = childrenList(inst._renderedChildren);\n    }\n  }\n\n  return {\n    nodeType,\n    type,\n    name,\n    props,\n    state,\n    context,\n    children,\n    text,\n    updater,\n    publicInstance,\n  };\n}\n\nfunction setInProps(\n  internalInst: any,\n  path: Array<string | number>,\n  value: any,\n) {\n  const element = internalInst._currentElement;\n  internalInst._currentElement = {\n    ...element,\n    props: copyWithSet(element.props, path, value),\n  };\n  internalInst._instance.forceUpdate();\n}\n\nfunction setInState(inst: any, path: Array<string | number>, value: any) {\n  setIn(inst.state, path, value);\n  inst.forceUpdate();\n}\n\nfunction setInContext(inst: any, path: Array<string | number>, value: any) {\n  setIn(inst.context, path, value);\n  inst.forceUpdate();\n}\n\nfunction setIn(obj: Object, path: Array<string | number>, value: any) {\n  const last = path.pop();\n  const parent = path.reduce((obj_, attr) => (obj_ ? obj_[attr] : null), obj);\n  if (parent) {\n    parent[last] = value;\n  }\n}\n\nfunction childrenList(children: any) {\n  const res = [];\n  for (const name in children) {\n    res.push(children[name]);\n  }\n  return res;\n}\n\nfunction copyWithSetImpl(\n  obj: any | Array<any>,\n  path: Array<string | number>,\n  idx: number,\n  value: any,\n): any {\n  if (idx >= path.length) {\n    return value;\n  }\n  const key = path[idx];\n  const updated = Array.isArray(obj) ? obj.slice() : {...obj};\n  // $FlowFixMe[incompatible-use] number or string is fine here\n  updated[key] = copyWithSetImpl(obj[key], path, idx + 1, value);\n  return updated;\n}\n\nfunction copyWithSet(\n  obj: Object | Array<any>,\n  path: Array<string | number>,\n  value: any,\n): Object | Array<any> {\n  return copyWithSetImpl(obj, path, 0, value);\n}\n\nmodule.exports = getData;\n"],"mappings":"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"}