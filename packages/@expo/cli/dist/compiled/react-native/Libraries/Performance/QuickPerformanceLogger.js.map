{"version":3,"names":["AUTO_SET_TIMESTAMP","DUMMY_INSTANCE_KEY","QuickPerformanceLogger","markerStart","markerId","instanceKey","arguments","length","undefined","timestamp","global","nativeQPLMarkerStart","markerEnd","actionId","nativeQPLMarkerEnd","markerTag","tag","nativeQPLMarkerTag","markerAnnotate","annotations","nativeQPLMarkerAnnotateWithMap","nativeQPLMarkerAnnotate","type","keyValsOfType","annotationKey","Object","keys","toString","markerCancel","markerDrop","markerPoint","name","data","nativeQPLMarkerPoint","nativeQPLMarkerDrop","markEvent","nativeQPLMarkEvent","currentTimestamp","nativeQPLTimestamp","module","exports"],"sources":["QuickPerformanceLogger.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * @flow strict\n */\n\n'use strict';\n\nconst AUTO_SET_TIMESTAMP = -1;\nconst DUMMY_INSTANCE_KEY = 0;\n\n// Defines map of annotations\n// Use as following:\n// {string: {key1: value1, key2: value2}}\nexport type AnnotationsMap = $Shape<{\n  string: ?{[string]: string, ...},\n  int: ?{[string]: number, ...},\n  double: ?{[string]: number, ...},\n  bool: ?{[string]: boolean, ...},\n  string_array: ?{[string]: $ReadOnlyArray<string>, ...},\n  int_array: ?{[string]: $ReadOnlyArray<number>, ...},\n  double_array: ?{[string]: $ReadOnlyArray<number>, ...},\n  bool_array: ?{[string]: $ReadOnlyArray<boolean>, ...},\n}>;\n\nconst QuickPerformanceLogger = {\n  markerStart(\n    markerId: number,\n    instanceKey: number = DUMMY_INSTANCE_KEY,\n    timestamp: number = AUTO_SET_TIMESTAMP,\n  ): void {\n    if (global.nativeQPLMarkerStart) {\n      global.nativeQPLMarkerStart(markerId, instanceKey, timestamp);\n    }\n  },\n\n  markerEnd(\n    markerId: number,\n    actionId: number,\n    instanceKey: number = DUMMY_INSTANCE_KEY,\n    timestamp: number = AUTO_SET_TIMESTAMP,\n  ): void {\n    if (global.nativeQPLMarkerEnd) {\n      global.nativeQPLMarkerEnd(markerId, instanceKey, actionId, timestamp);\n    }\n  },\n\n  markerTag(\n    markerId: number,\n    tag: string,\n    instanceKey: number = DUMMY_INSTANCE_KEY,\n  ): void {\n    if (global.nativeQPLMarkerTag) {\n      global.nativeQPLMarkerTag(markerId, instanceKey, tag);\n    }\n  },\n\n  markerAnnotate(\n    markerId: number,\n    annotations: AnnotationsMap,\n    instanceKey: number = DUMMY_INSTANCE_KEY,\n  ): void {\n    if (global.nativeQPLMarkerAnnotateWithMap) {\n      global.nativeQPLMarkerAnnotateWithMap(markerId, annotations, instanceKey);\n    } else if (global.nativeQPLMarkerAnnotate) {\n      for (const type of [\n        'string',\n        'int',\n        'double',\n        'bool',\n        'string_array',\n        'int_array',\n        'double_array',\n        'bool_array',\n      ]) {\n        const keyValsOfType = annotations[type];\n        if (keyValsOfType != null) {\n          for (const annotationKey of Object.keys(keyValsOfType)) {\n            global.nativeQPLMarkerAnnotate(\n              markerId,\n              instanceKey,\n              annotationKey,\n              keyValsOfType[annotationKey].toString(),\n            );\n          }\n        }\n      }\n    }\n  },\n\n  markerCancel(\n    markerId: number,\n    instanceKey?: number = DUMMY_INSTANCE_KEY,\n  ): void {\n    // $FlowFixMe[object-this-reference]\n    this.markerDrop(markerId, instanceKey);\n  },\n\n  markerPoint(\n    markerId: number,\n    name: string,\n    instanceKey: number = DUMMY_INSTANCE_KEY,\n    timestamp: number = AUTO_SET_TIMESTAMP,\n    data: ?string = null,\n  ): void {\n    if (global.nativeQPLMarkerPoint) {\n      global.nativeQPLMarkerPoint(markerId, name, instanceKey, timestamp, data);\n    }\n  },\n\n  markerDrop(\n    markerId: number,\n    instanceKey?: number = DUMMY_INSTANCE_KEY,\n  ): void {\n    if (global.nativeQPLMarkerDrop) {\n      global.nativeQPLMarkerDrop(markerId, instanceKey);\n    }\n  },\n\n  markEvent(\n    markerId: number,\n    type: string,\n    annotations: ?AnnotationsMap = null,\n  ): void {\n    if (global.nativeQPLMarkEvent) {\n      global.nativeQPLMarkEvent(markerId, type, annotations);\n    }\n  },\n\n  currentTimestamp(): number {\n    if (global.nativeQPLTimestamp) {\n      return global.nativeQPLTimestamp();\n    }\n    return 0;\n  },\n};\n\nmodule.exports = QuickPerformanceLogger;\n"],"mappings":"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"}