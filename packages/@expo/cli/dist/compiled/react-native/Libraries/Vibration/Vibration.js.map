{"version":3,"names":["_NativeVibration","_interopRequireDefault","require","Platform","_vibrating","_id","_default_vibration_length","vibrateByPattern","pattern","repeat","arguments","length","undefined","NativeVibration","vibrate","slice","setTimeout","vibrateScheduler","id","nextIndex","Vibration","OS","Array","isArray","Error","cancel","module","exports"],"sources":["Vibration.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * @flow strict\n * @jsdoc\n */\n\nimport NativeVibration from './NativeVibration';\n\nconst Platform = require('../Utilities/Platform');\n\n/**\n * Vibration API\n *\n * See https://reactnative.dev/docs/vibration\n */\n\nlet _vibrating: boolean = false;\nlet _id: number = 0; // _id is necessary to prevent race condition.\nconst _default_vibration_length = 400;\n\nfunction vibrateByPattern(pattern: Array<number>, repeat: boolean = false) {\n  if (_vibrating) {\n    return;\n  }\n  _vibrating = true;\n  if (pattern[0] === 0) {\n    NativeVibration.vibrate(_default_vibration_length);\n    // $FlowFixMe[reassign-const]\n    pattern = pattern.slice(1);\n  }\n  if (pattern.length === 0) {\n    _vibrating = false;\n    return;\n  }\n  setTimeout(() => vibrateScheduler(++_id, pattern, repeat, 1), pattern[0]);\n}\n\nfunction vibrateScheduler(\n  id: number,\n  pattern: Array<number>,\n  repeat: boolean,\n  nextIndex: number,\n) {\n  if (!_vibrating || id !== _id) {\n    return;\n  }\n  NativeVibration.vibrate(_default_vibration_length);\n  if (nextIndex >= pattern.length) {\n    if (repeat) {\n      // $FlowFixMe[reassign-const]\n      nextIndex = 0;\n    } else {\n      _vibrating = false;\n      return;\n    }\n  }\n  setTimeout(\n    () => vibrateScheduler(id, pattern, repeat, nextIndex + 1),\n    pattern[nextIndex],\n  );\n}\n\nconst Vibration = {\n  /**\n   * Trigger a vibration with specified `pattern`.\n   *\n   * See https://reactnative.dev/docs/vibration#vibrate\n   */\n  vibrate: function (\n    pattern: number | Array<number> = _default_vibration_length,\n    repeat: boolean = false,\n  ) {\n    if (Platform.OS === 'android') {\n      if (typeof pattern === 'number') {\n        NativeVibration.vibrate(pattern);\n      } else if (Array.isArray(pattern)) {\n        NativeVibration.vibrateByPattern(pattern, repeat ? 0 : -1);\n      } else {\n        throw new Error('Vibration pattern should be a number or array');\n      }\n    } else {\n      if (_vibrating) {\n        return;\n      }\n      if (typeof pattern === 'number') {\n        NativeVibration.vibrate(pattern);\n      } else if (Array.isArray(pattern)) {\n        vibrateByPattern(pattern, repeat);\n      } else {\n        throw new Error('Vibration pattern should be a number or array');\n      }\n    }\n  },\n  /**\n   * Stop vibration\n   *\n   * See https://reactnative.dev/docs/vibration#cancel\n   */\n  cancel: function () {\n    if (Platform.OS === 'ios') {\n      _vibrating = false;\n    } else {\n      NativeVibration.cancel();\n    }\n  },\n};\n\nmodule.exports = Vibration;\n"],"mappings":"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"}